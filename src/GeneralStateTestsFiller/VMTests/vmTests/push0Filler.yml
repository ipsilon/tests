# EIP-3855: PUSH0 instruction
push0:
  env:
    currentCoinbase: 2adc25665018aa1fe0e6bc666dac8fc2697ff9ba
    currentDifficulty: '0x020000'
    currentGasLimit: '89128960'
    currentBaseFee: '10'
    currentNumber: '1'
    currentTimestamp: '1000'
    previousHash: 5e20a0453cecd065ea59c37ac63e079ee08998b6045136a8ce6635c7912ec0b6

  pre:
    a94f5374fce5edbc8e2a8697c15331677e6ebf0b:
      balance: 0x100000000000
      code: ''
      nonce: '0'
      storage: {}

    b94f5374fce5edbc8e2a8697c15331677e6ebf0b:
      balance: 0
      code: ':yul { sstore(0, call(100000, shr(96, calldataload(0)), 0, 0, 0, 0, 0)) sstore(1, 1) }'
      nonce: 0
      storage: {}

    0000000000000000000000000000000000000100:
      balance: 0
      # push1(01) push0 sstore
      code: ':raw 0x60015f55'
      nonce: '0'
      storage: {}
      
    0000000000000000000000000000000000000200:
      balance: 0
      # 1024 push0's, 1023 or's, push1(01) swap1 sstore
      code: ":raw 0x\
        5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f\
        5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f\
        5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f\
        5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f\
        5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f\
        5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f\
        5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f\
        5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f\
        5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f\
        5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f\
        5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f\
        5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f\
        5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f\
        5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f\
        5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f\
        5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f\
        17171717171717171717171717171717171717171717171717171717171717171717171717171717171717171717171717171717171717171717171717171717\
        17171717171717171717171717171717171717171717171717171717171717171717171717171717171717171717171717171717171717171717171717171717\
        17171717171717171717171717171717171717171717171717171717171717171717171717171717171717171717171717171717171717171717171717171717\
        17171717171717171717171717171717171717171717171717171717171717171717171717171717171717171717171717171717171717171717171717171717\
        17171717171717171717171717171717171717171717171717171717171717171717171717171717171717171717171717171717171717171717171717171717\
        17171717171717171717171717171717171717171717171717171717171717171717171717171717171717171717171717171717171717171717171717171717\
        17171717171717171717171717171717171717171717171717171717171717171717171717171717171717171717171717171717171717171717171717171717\
        17171717171717171717171717171717171717171717171717171717171717171717171717171717171717171717171717171717171717171717171717171717\
        17171717171717171717171717171717171717171717171717171717171717171717171717171717171717171717171717171717171717171717171717171717\
        17171717171717171717171717171717171717171717171717171717171717171717171717171717171717171717171717171717171717171717171717171717\
        17171717171717171717171717171717171717171717171717171717171717171717171717171717171717171717171717171717171717171717171717171717\
        17171717171717171717171717171717171717171717171717171717171717171717171717171717171717171717171717171717171717171717171717171717\
        17171717171717171717171717171717171717171717171717171717171717171717171717171717171717171717171717171717171717171717171717171717\
        17171717171717171717171717171717171717171717171717171717171717171717171717171717171717171717171717171717171717171717171717171717\
        17171717171717171717171717171717171717171717171717171717171717171717171717171717171717171717171717171717171717171717171717171717\
        171717171717171717171717171717171717171717171717171717171717171717171717171717171717171717171717171717171717171717171717171717\
        60019055"
      nonce: '0'
      storage: {}

    0000000000000000000000000000000000000300:
      balance: 0
      # 1025 push0's
      code: ":raw 0x\
        5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f\
        5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f\
        5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f\
        5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f\
        5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f\
        5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f\
        5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f\
        5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f\
        5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f\
        5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f\
        5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f\
        5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f\
        5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f\
        5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f\
        5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f\
        5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f\
        5f"
      nonce: '0'
      storage: {}
    0000000000000000000000000000000000000400:
      balance: 0
      # push1(02) push0 sstore push1(00) push1(01) sstore
      code: ':raw 0x60025f556000600155'
      nonce: '0'
      storage: {0: 0x0a, 1: 0x0a}

    0000000000000000000000000000000000000500:
      balance: 0
      code: ':yul { sstore(0, staticcall(100000, 0x0000000000000000000000000000000000000400, 0, 0, 0, 0)) sstore(1, 1) }'
      nonce: 0
      storage: {}

  transaction:
    data:
      - ':label single_push0 :raw 0x0000000000000000000000000000000000000100'
      - ':label 1024_push0   :raw 0x0000000000000000000000000000000000000200'
      - ':label 1025_push0   :raw 0x0000000000000000000000000000000000000300'
      - ':label push0_upd_storage :raw 0x0000000000000000000000000000000000000400'
      - ':label push0_upd_storage_sc :raw 0x0000000000000000000000000000000000000500'
    gasLimit:
      - 700000
    gasPrice: 10
    nonce: 0
    secretKey: 45a915e4d060149eb4365960e6a7a45f334393093061116b197e3240065ff2d8
    to: 'b94f5374fce5edbc8e2a8697c15331677e6ebf0b'
    value:
    - 0
        
  expect:
    - indexes:
        data: ':label single_push0'
        gas:  !!int -1
        value: !!int -1
      network:
        - 'London'
      result:
        0000000000000000000000000000000000000100:
          storage: {}
        b94f5374fce5edbc8e2a8697c15331677e6ebf0b:
          storage:
            0x01: 0x01
    - indexes:
        data: ':label single_push0'
        gas:  !!int -1
        value: !!int -1
      network:
        - 'London+3855'
      result:
        0000000000000000000000000000000000000100:
          storage:
            0x00: 0x01
        b94f5374fce5edbc8e2a8697c15331677e6ebf0b:
          storage:
            0x00: 0x01
            0x01: 0x01

    - indexes:
        data: ':label 1024_push0'
        gas:  !!int -1
        value: !!int -1
      network:
        - 'London'
      result:
        0000000000000000000000000000000000000200:
          storage: {}
        b94f5374fce5edbc8e2a8697c15331677e6ebf0b:
          storage:
            0x01: 0x01
    - indexes:
        data: ':label 1024_push0'
        gas:  !!int -1
        value: !!int -1
      network:
        - 'London+3855'
      result:
        0000000000000000000000000000000000000200:
          storage:
            0x00: 0x01
        b94f5374fce5edbc8e2a8697c15331677e6ebf0b:
          storage:
            0x00: 0x01
            0x01: 0x01

    - indexes:
        data: ':label 1025_push0'
        gas:  !!int -1
        value: !!int -1
      network:
        - 'London'
      result:
        b94f5374fce5edbc8e2a8697c15331677e6ebf0b:
          storage:
            0x01: 0x01
    # Same expectation, but for London execution fails on 5f opcode, for 3855 it fails with stack overflow     
    - indexes:
        data: ':label 1025_push0'
        gas:  !!int -1
        value: !!int -1
      network:
        - 'London+3855'
      result:
        b94f5374fce5edbc8e2a8697c15331677e6ebf0b:
          storage:
            0x01: 0x01
    - indexes:
        data: ':label push0_upd_storage'
        gas:  !!int -1
        value: !!int -1
      network:
        - 'London'
      result:
        0000000000000000000000000000000000000400:
          storage:
            0x00: 0x0a
            0x01: 0x0a
        b94f5374fce5edbc8e2a8697c15331677e6ebf0b:
          storage:
            0x01: 0x01
    - indexes:
        data: ':label push0_upd_storage'
        gas:  !!int -1
        value: !!int -1
      network:
        - 'London+3855'
      result:
        0000000000000000000000000000000000000400:
          storage:
            0x00: 0x02
            0x01: 0x00
        b94f5374fce5edbc8e2a8697c15331677e6ebf0b:
          storage:
            0x00: 0x01
            0x01: 0x01
    - indexes:
        data: ':label push0_upd_storage_sc'
        gas:  !!int -1
        value: !!int -1
      network:
        - 'London'
      result:
        0000000000000000000000000000000000000400:
          storage:
            0x00: 0x0a # storage not updated
            0x01: 0x0a # storage not updated 
        0000000000000000000000000000000000000500:
          storage:
            0x00: 0x00 # 0x00..0400 failed (attempting sstore)
            0x01: 0x00
        b94f5374fce5edbc8e2a8697c15331677e6ebf0b:
          storage:
            0x00: 0x00
            0x01: 0x01
    - indexes:
        data: ':label push0_upd_storage_sc'
        gas:  !!int -1
        value: !!int -1
      network:
        - 'London+3855'
      result:
        0000000000000000000000000000000000000400:
          storage:
            0x00: 0x0a  # storage not updated
            0x01: 0x0a  # storage not updated
        0000000000000000000000000000000000000500:
          storage:
            0x00: 0x00 # 0x00..0400 failed (attempting sstore)
            0x01: 0x00
        b94f5374fce5edbc8e2a8697c15331677e6ebf0b:
          storage:
            0x00: 0x00
            0x01: 0x01

